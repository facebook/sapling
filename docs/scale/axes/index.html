<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-scale/axes" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Axes of scale | Sapling</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://sapling-scm.com/docs/scale/axes><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Axes of scale | Sapling"><meta data-rh=true name=description content="Source control clients face many different kinds of scaling challenges.  This document aims to list those various challenges, and provide an ultra-concise explanation of how we tackle it.  Links to deeper documents will cover individual areas in more depth."><meta data-rh=true property=og:description content="Source control clients face many different kinds of scaling challenges.  This document aims to list those various challenges, and provide an ultra-concise explanation of how we tackle it.  Links to deeper documents will cover individual areas in more depth."><link data-rh=true rel=icon href=/img/Sapling_favicon-light-green-transparent-big.svg><link data-rh=true rel=canonical href=https://sapling-scm.com/docs/scale/axes><link data-rh=true rel=alternate href=https://sapling-scm.com/docs/scale/axes hreflang=en><link data-rh=true rel=alternate href=https://sapling-scm.com/docs/scale/axes hreflang=x-default><link rel=stylesheet href=/assets/css/styles.061bfe20.css><script src=/assets/js/runtime~main.e4f0349a.js defer></script><script src=/assets/js/main.7f1c2819.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id=internaldocs-banner></div><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/Sapling_icon-dark-green.svg alt="Sapling Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/Sapling_icon-dark-green.svg alt="Sapling Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Sapling</b></a><a class="navbar__item navbar__link" href=/docs/introduction/>Documentation</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/facebook/sapling target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/introduction>Introduction</a><button aria-label="Expand sidebar category 'Introduction'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/overview>Overview</a><button aria-label="Expand sidebar category 'Overview'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/git-interop>Git Interop</a><button aria-label="Expand sidebar category 'Git Interop'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/commands>Commands</a><button aria-label="Expand sidebar category 'Commands'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/add-ons>Add-ons</a><button aria-label="Expand sidebar category 'Add-ons'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/category/working-at-scale>Working at Scale</a><button aria-label="Collapse sidebar category 'Working at Scale'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/scale/overview>Overview</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/scale/axes>Axes of scale</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/scale/organizational>Organizational scale</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/dev/>Developer Guide</a><button aria-label="Expand sidebar category 'Developer Guide'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/faqs>FAQs</a></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/category/working-at-scale><span itemprop=name>Working at Scale</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Axes of scale</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Axes of scale</h1></header>
<p>Source control clients face many different kinds of scaling challenges.  This document aims to list those various challenges, and provide an ultra-concise explanation of how we tackle it.  Links to deeper documents will cover individual areas in more depth.</p>
<p>Two notes before reading:</p>
<ol>
<li>The problems below are specific to source control clients, that is, the piece that you run on your local computer.  The source control server faces similar scaling challenges and unique solutions, but those are not covered here.</li>
<li>Some of the solutions described below require the Sapling client to work with the Sapling server.  When using the Sapling client with a Git server, some of these optimizations do not apply.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=working-copy-scale>Working copy scale<a href=#working-copy-scale class=hash-link aria-label="Direct link to Working copy scale" title="Direct link to Working copy scale">​</a></h2>
<p>The working copy consists of all the files you have checked out and interact with.  This is all the files in your repository directory, except the ones in the .sl directory.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=number-of-files>Number of files<a href=#number-of-files class=hash-link aria-label="Direct link to Number of files" title="Direct link to Number of files">​</a></h3>
<p>Having millions of files in the working copy causes numerous problems for traditional version control. Checkouts are slow because we must download and write all of those files to disk.  Status is slow because we must scan every file in the working copy to determine what has changed.</p>
<p>Sapling tackles large numbers of files in three ways:</p>
<ul>
<li>The Watchman filesystem monitor lets Sapling monitor what files have changed, allowing it to answer status queries in O(files-you-have-changed) time instead of scanning the repository.</li>
<li>The sparse feature allows users to only checkout the files that are relevant to them.</li>
<li>The Sapling compatible virtual filesystem makes it appear as though you have the entire repository, but files are only downloaded when you first access them.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=size-of-files>Size of files<a href=#size-of-files class=hash-link aria-label="Direct link to Size of files" title="Direct link to Size of files">​</a></h3>
<p>Moderately large files (10MB-2GB) are not a major source of scaling problems, but still require special consideration.  Large files are downloaded from a special server that speaks the Git LFS protocol to avoid overloading the primary source control service.  Large files are also stored locally in their own portion of the data cache, so that they have their own cache size limit and don’t swamp the other kinds of data.</p>
<p>Files larger than 2GB are currently not battle-tested in Sapling, though they may still work.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=size-of-directories>Size of directories<a href=#size-of-directories class=hash-link aria-label="Direct link to Size of directories" title="Direct link to Size of directories">​</a></h3>
<p>Large directories are those with thousands or tens of thousands of immediate children files or directories.  It does not refer to directories which recursively contains many files or directories.</p>
<p>Directories up to a few thousand children are reasonably well supported in Sapling. Beyond that performance starts to degrade.  Further optimizations are possible, but this is not an issue on the current Sapling-based monorepos and thus far not a priority.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=repository-scale>Repository scale<a href=#repository-scale class=hash-link aria-label="Direct link to Repository scale" title="Direct link to Repository scale">​</a></h2>
<p>The repository consists of all the behind-the-scenes, non-working-copy repository data that is stored in the .sl directory. Similar to the .git directory in Git.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=number-of-commits>Number of commits<a href=#number-of-commits class=hash-link aria-label="Direct link to Number of commits" title="Direct link to Number of commits">​</a></h3>
<p>The total number of commits in a repository constantly grows over time, and in a large organization can easily reach millions or tens of millions of commits.  This affects a wide variety of performance characteristics:</p>
<ul>
<li>Storing all the commit data (messages, author, metadata, etc.) can take gigabytes of space. Note, this does not include the cost of storing file and tree data.</li>
<li>Running <code>sl log</code> with particular constraints may have to read a large number of commits.</li>
<li>Common graph queries, like ‘common ancestor’, used in many commands, like <code>smartlog</code> and <code>rebase</code>, can become slow.</li>
<li>Computing the shortest unique hash prefix to provide pleasing UI output can become expensive.</li>
</ul>
<p>Sapling takes several approaches to handle this:</p>
<ul>
<li>History data (i.e. the graph relationships) and commit metadata (i.e. messages, authors, etc) are stored separately. This allows us to download lots of history data for graph computations, while downloading a more limited amount of commit metadata.</li>
<li>Commit metadata is downloaded lazily. When you first clone a repository, no commit messages are downloaded. Only once you start inspecting commits, via <code>smartlog</code>, <code>show</code>, etc, individual commit metadata is downloaded as needed. This makes clones fast, and reduces the amount of disk space required to O(commits you are interested in).</li>
<li>History data is stored using the Segmented Changelog. This is a data structure that represents the shape of the entire commit graph using segments to concisely represent large swaths of history.  The segmented changelog can be represented in just a few megabytes and can answer graph query questions in O(number-of-merges) time, or just a few milliseconds even in a large monorepo.</li>
<li><code>log</code> with certain constraints, such as trying to find all commits by a certain user, may still need to inspect a lot of commits.  Sapling attempts to make <code>log</code> more efficient by batch-fetching commit data, in order to avoid one-by-one serial fetches.  Additionally, <code>log</code> on files and directories has special support, discussed below.</li>
<li>Computing the shortest unique hash for a given commit is done by maintaining an incrementally updatable tree-like index of all locally-available commit hashes.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=number-of-branchesbookmarks>Number of branches/bookmarks<a href=#number-of-branchesbookmarks class=hash-link aria-label="Direct link to Number of branches/bookmarks" title="Direct link to Number of branches/bookmarks">​</a></h3>
<p>As the number of remote bookmarks (similar to a Git remote branch) in a repository grows over time, this can result in large number of remote bookmarks being downloaded and monitored by the client. This can cause slowness when talking to the server, as each bookmark needs to be checked, and generally clutters the local user experience.</p>
<p>Sapling defaults to not downloading every bookmark from the server. Instead, during a clone you receive the <code>main</code> or <code>master</code> bookmark, and a configurable list of specific other bookmarks.  Users can choose to subscribe to specific bookmarks via <code>sl pull -B</code>.  Sapling also transparently downloads bookmarks if the users uses them in commands. For instance, if a user runs <code>sl goto release_123</code> but they don’t have that remote bookmark, Sapling will automatically download it to complete the checkout.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=quantity-of-historical-filetree-data>Quantity of historical file/tree data<a href=#quantity-of-historical-filetree-data class=hash-link aria-label="Direct link to Quantity of historical file/tree data" title="Direct link to Quantity of historical file/tree data">​</a></h3>
<p>During a normal distributed source control pull or clone you download all the new files and trees that have been changed, resulting in your local client having all of history. In a large repository, this quantity of data may be so large that it is slow and impractical to download all of it to individual clients.</p>
<p>Sapling, on the other hand, does not download tree and file data durings pull and clones. That data is left on the server, and the Sapling client downloads it on demand when later required, such as during a checkout.  The on demand nature of Sapling commands requires carefully designed algorithms to ensure data is fetched efficiently and in parallel.</p>
<p>Lazily downloading data means Sapling may need network access to perform operations that would traditionally be doable offline.  To support some offline work, Sapling keeps all of the downloaded data in a local cache with a bounded size.  This cache generally contains enough data to move between, inspect, commit, and amend on any of your recently in-progress commits.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=length-of-file-history>Length of file history<a href=#length-of-file-history class=hash-link aria-label="Direct link to Length of file history" title="Direct link to Length of file history">​</a></h3>
<p>In many version control systems, running commands like <code>log</code> and <code>blame</code> on a file or directory often have to walk every commit in the repository looking for commits that touched that file or directory. This is an O(size of repo) operation.</p>
<p>For files, Sapling makes these operations O(changes to that file) by tracking the exact history of each individual file, in addition to the history of the entire commit graph.  This allows log and blame to be fast, regardless of the size of the repository.</p>
<p>For directories, Sapling also tracks the history of a directory, but using this information to answer history queries is not yet implemented. Instead, Sapling can query the Sapling server for a directory’s history, which allows using the server's superior indexes to answer the query quickly.</p>
<p>Additionally, in the case where the server isn't available, Sapling can bisect over the Segmented Changelog structure to look for the commits that changed the given file or directory. This allows figuring out an approximate history in O(log n) time, though it may miss cases where a file or directory is changed, then reverted back to a previous version.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=number-of-commits-per-hour>Number of commits per hour<a href=#number-of-commits-per-hour class=hash-link aria-label="Direct link to Number of commits per hour" title="Direct link to Number of commits per hour">​</a></h3>
<p>In a large organization the number of commits being pushed per minute introduces additional scaling challenges.</p>
<p><strong>Rebase races</strong></p>
<p>In Git or Mercurial, in order to push to the <code>main</code> branch you must first pull and rebase/merge onto the latest main branch.  If someone pushes before you, then you have to repeat the process until you win. If there are many people competing, it can become almost impossible to actually push your commit.</p>
<p>In Sapling, when you push to the Sapling server, the server actually takes your commit and rebases it to be on the top of bookmark you are pushing to.  So if someone else pushed before you, it’s ok because the server just moves your commit up to the top.  If someone else edited a file you touched, then the push will fail and you must manually rebase to merge the file.  There is still the potential for races where two people modify two different files in incompatible ways, but in practice this has not been an issue.</p>
<p><strong>Code generation races</strong></p>
<p>A large amount of commit throughput also introduces problems if your repository contains generated files.  If you modify a file that requires regenerating, then if someone else does the same and pushes first, you need to rebase over their change and once again regenerate the files.  The time taken to generate the file means the window in which you could lose the race becomes quite large, and it can become impossible to win the race if many people are changing the same generated files.</p>
<p>While Sapling doesn’t completely solve this, it improves the user experience by supporting calling code generators to solve rebase conflicts.  This allows conflicts in generated code to be handled at rebase time and allows code-pushing automation to automatically regenerate code on the users behalf when it encounters a push failure due to a conflict.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/facebook/sapling/tree/main/website/docs/scale/axes.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/scale/overview><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/scale/organizational><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Organizational scale</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#working-copy-scale class="table-of-contents__link toc-highlight">Working copy scale</a><ul><li><a href=#number-of-files class="table-of-contents__link toc-highlight">Number of files</a><li><a href=#size-of-files class="table-of-contents__link toc-highlight">Size of files</a><li><a href=#size-of-directories class="table-of-contents__link toc-highlight">Size of directories</a></ul><li><a href=#repository-scale class="table-of-contents__link toc-highlight">Repository scale</a><ul><li><a href=#number-of-commits class="table-of-contents__link toc-highlight">Number of commits</a><li><a href=#number-of-branchesbookmarks class="table-of-contents__link toc-highlight">Number of branches/bookmarks</a><li><a href=#quantity-of-historical-filetree-data class="table-of-contents__link toc-highlight">Quantity of historical file/tree data</a><li><a href=#length-of-file-history class="table-of-contents__link toc-highlight">Length of file history</a><li><a href=#number-of-commits-per-hour class="table-of-contents__link toc-highlight">Number of commits per hour</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Useful Links</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/facebook/sapling target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://discord.gg/X6baZ94Vzh target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://twitter.com/MetaOpenSource target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://opensource.fb.com/ target=_blank rel="noopener noreferrer" class=footer__link-item>Meta Open Source<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Related Projects</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/ezyang/ghstack target=_blank rel="noopener noreferrer" class=footer__link-item>ghstack<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://github.com/facebook/watchman target=_blank rel="noopener noreferrer" class=footer__link-item>Watchman<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://github.com/facebookexperimental/fb-vscode target=_blank rel="noopener noreferrer" class=footer__link-item>VS Code @ Meta<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Legal</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://opensource.fb.com/legal/privacy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Privacy<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://opensource.fb.com/legal/terms/ target=_blank rel="noopener noreferrer" class=footer__link-item>Terms<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://opensource.fb.com/legal/data-policy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Data Policy<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://opensource.fb.com/legal/cookie-policy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Cookie Policy<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><a href=https://opensource.fb.com rel="noopener noreferrer" class=footerLogoLink_BH7S><img src=/img/meta_opensource_logo_negative.svg alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/meta_opensource_logo_negative.svg alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class=footer__copyright>Copyright © 2025 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>