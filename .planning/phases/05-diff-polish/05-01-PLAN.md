---
phase: 05-diff-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - addons/components/theme/themeDark.css
  - addons/components/theme/themeLight.css
autonomous: true

must_haves:
  truths:
    - "Addition lines show soft cyan-blue background (not harsh green)"
    - "Deletion lines show salmon/soft red background (not harsh red)"
    - "Intraline word highlights are slightly more saturated than line backgrounds"
    - "Overall diff view feels muted and easy on eyes"
  artifacts:
    - path: "addons/components/theme/themeDark.css"
      provides: "Graphite-style diff colors for dark theme"
      contains: "--diffEditor-insertedLineBackground"
    - path: "addons/components/theme/themeLight.css"
      provides: "Graphite-style diff colors for light theme"
      contains: "--diffEditor-insertedLineBackground"
  key_links:
    - from: "addons/components/theme/themeDark.css"
      to: "addons/isl/src/ComparisonView/SplitDiffView/SplitDiffHunk.css"
      via: "CSS custom property inheritance"
      pattern: "--diffEditor-(inserted|removed)Line"
---

<objective>
Transform diff colors from default harsh green/red to Graphite-style muted tones.

Purpose: The team is used to Graphite's soft color palette. Harsh green/red diff colors cause eye strain during long code review sessions. Soft cyan-blue additions and salmon deletions create a professional, easy-on-the-eyes aesthetic.

Output: Updated theme CSS files with Graphite-inspired diff colors.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-diff-polish/05-CONTEXT.md

@addons/components/theme/themeDark.css
@addons/components/theme/themeLight.css
@addons/isl/src/ComparisonView/SplitDiffView/SplitDiffHunk.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update dark theme diff colors</name>
  <files>addons/components/theme/themeDark.css</files>
  <action>
Update the four `--diffEditor-*` CSS custom properties (lines 36-52) in themeDark.css:

**Additions (soft cyan-blue):**
- `--diffEditor-insertedLineBackground`: Change from green (`rgba(155, 185, 85, 0.2)`) to soft cyan-blue. Use a very desaturated blue with ~15-20% opacity that complements `--graphite-bg: #1a1f36`. Example: `rgba(88, 166, 255, 0.15)` or similar.
- `--diffEditor-insertedLineHighlightBackground`: Slightly more saturated version for intraline word highlights. Example: `rgba(88, 166, 255, 0.30)`.

**Deletions (salmon/soft red):**
- `--diffEditor-removedLineBackground`: Change from harsh red (`rgba(255, 0, 0, 0.2)`) to warm salmon/peachy-red. Use a muted coral-pink with ~15-20% opacity. Example: `rgba(248, 150, 130, 0.18)` or similar.
- `--diffEditor-removedLineHighlightBackground`: Slightly more saturated version for intraline word highlights. Example: `rgba(248, 150, 130, 0.35)`.

**Guidelines:**
- Keep fallback to vscode variables (the `var(--vscode-diffEditor-*, fallback)` pattern)
- Colors should be muted, NOT bright or saturated
- Aim for ~15-20% opacity for line backgrounds, ~30-35% for word highlights
- Test visually that colors are clearly distinguishable but not jarring
  </action>
  <verify>
Run `cd /Users/jonas/code/sapling/addons && yarn build` successfully.
Open ISL dev server (`cd /Users/jonas/code/sapling/addons/isl && yarn start`), navigate to a commit with file changes, and visually confirm:
- Addition lines have soft blue tint
- Deletion lines have salmon/coral tint
- Intraline word highlights are visible but not harsh
  </verify>
  <done>Dark theme diffs show soft cyan-blue additions and salmon deletions instead of harsh green/red</done>
</task>

<task type="auto">
  <name>Task 2: Update light theme diff colors</name>
  <files>addons/components/theme/themeLight.css</files>
  <action>
Update the four `--diffEditor-*` CSS custom properties (lines 36-52) in themeLight.css to match the Graphite aesthetic for light mode:

**Additions (soft blue):**
- `--diffEditor-insertedLineBackground`: Soft blue that works on white/light backgrounds. Example: `rgba(66, 133, 244, 0.12)`.
- `--diffEditor-insertedLineHighlightBackground`: More saturated blue for word highlights. Example: `rgba(66, 133, 244, 0.25)`.

**Deletions (soft coral/salmon):**
- `--diffEditor-removedLineBackground`: Soft coral that works on light backgrounds. Example: `rgba(234, 134, 118, 0.18)`.
- `--diffEditor-removedLineHighlightBackground`: More saturated coral for word highlights. Example: `rgba(234, 134, 118, 0.35)`.

**Guidelines:**
- Keep fallback to vscode variables (the `var(--vscode-diffEditor-*, fallback)` pattern)
- Light theme colors need slightly different saturation/opacity to be visible on white
- Maintain muted aesthetic - NOT GitHub's bright green/red
  </action>
  <verify>
Toggle to light theme in ISL (if supported) or check themeLight.css syntax is valid.
Colors should be harmonious with the light theme palette.
  </verify>
  <done>Light theme diffs also use soft blue/salmon colors matching Graphite aesthetic</done>
</task>

</tasks>

<verification>
1. Build completes without errors: `cd addons && yarn build`
2. Visual verification in dark theme (primary):
   - Navigate to any commit with changes
   - Addition lines: soft blue-gray tint (NOT bright green)
   - Deletion lines: warm salmon/coral tint (NOT harsh red)
   - Intraline highlights: visible but subtle
3. Colors complement existing Graphite palette (#1a1f36 navy, #4a90e2 accent)
</verification>

<success_criteria>
- [ ] themeDark.css has updated `--diffEditor-*` values with soft blue/salmon colors
- [ ] themeLight.css has updated `--diffEditor-*` values for light mode
- [ ] Build passes without errors
- [ ] Visual inspection confirms muted, professional diff appearance
- [ ] Requirement STYLE-02 satisfied: "Diff highlighting uses Graphite colors"
</success_criteria>

<output>
After completion, create `.planning/phases/05-diff-polish/05-01-SUMMARY.md`
</output>
