---
phase: 06-navigation-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - addons/isl/src/RenderDag.css
  - addons/isl/src/CommitTreeList.css
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "scroll-margin-top is applied to the element that scrollIntoView targets"
    - "Selected commit appears at viewport top with 30px padding"
  artifacts:
    - path: "addons/isl/src/RenderDag.css"
      provides: "scroll-margin-top on .render-dag-row class"
      contains: "scroll-margin-top: 30px"
    - path: "addons/isl/src/CommitTreeList.css"
      provides: "No duplicate scroll-margin-top on .commit-rows"
      contains_not: "scroll-margin-top"
  key_links:
    - from: "addons/isl/src/CommitTreeList.tsx"
      to: "[data-commit-hash] element"
      via: "querySelector"
      pattern: 'querySelector.*data-commit-hash'
    - from: "[data-commit-hash] element"
      to: ".render-dag-row class"
      via: "RenderDag DivRow component"
      pattern: "data-commit-hash.*render-dag-row"
---

<objective>
Fix scroll-margin-top placement so it applies to the correct element being scrolled.

Purpose: Gap closure from verification. The scroll-margin-top: 30px was added to .commit-rows (child element) but scrollIntoView targets [data-commit-hash] which is on .render-dag-row (parent element). CSS scroll-margin-top must be on the scrolled element itself.

Output: scroll-margin-top moved to .render-dag-row in RenderDag.css, removed from CommitTreeList.css
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-navigation-fixes/06-01-VERIFICATION.md

Gap source: 06-01-VERIFICATION.md shows scroll-margin-top is on wrong CSS class.

Relevant code:
- addons/isl/src/RenderDag.tsx line 396: data-commit-hash is set on DivRow (class .render-dag-row)
- addons/isl/src/RenderDag.css lines 19-25: .render-dag-row styles
- addons/isl/src/CommitTreeList.tsx line 264: querySelector finds [data-commit-hash]
- addons/isl/src/CommitTreeList.css line 119: scroll-margin-top currently on .commit-rows (wrong)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move scroll-margin-top to correct element</name>
  <files>addons/isl/src/RenderDag.css, addons/isl/src/CommitTreeList.css</files>
  <action>
1. Add `scroll-margin-top: 30px;` to the `.render-dag-row` rule in RenderDag.css (lines 19-25)

Current rule:
```css
.render-dag-row,
.render-dag-row-left-side-line {
  padding-left: var(--pad);
  display: flex;
  flex-direction: row;
  flex-grow: 0;
}
```

Updated rule (add scroll-margin-top only to .render-dag-row, not the combined selector):
```css
.render-dag-row {
  scroll-margin-top: 30px;
}

.render-dag-row,
.render-dag-row-left-side-line {
  padding-left: var(--pad);
  display: flex;
  flex-direction: row;
  flex-grow: 0;
}
```

2. Remove `scroll-margin-top: 30px;` from `.commit-rows` in CommitTreeList.css (line 119)

This ensures scroll-margin-top is on the element with data-commit-hash attribute (the element scrollIntoView targets), not its child.
  </action>
  <verify>
1. Grep RenderDag.css for scroll-margin-top - should find it on .render-dag-row
2. Grep CommitTreeList.css for scroll-margin-top - should NOT find it
3. Run `cd /Users/jonas/code/sapling/addons/isl && yarn build` - should build without CSS errors
  </verify>
  <done>
scroll-margin-top: 30px is on .render-dag-row (the element with data-commit-hash), not on .commit-rows (the child element). scrollIntoView will now correctly apply the 30px top padding.
  </done>
</task>

</tasks>

<verification>
After task completes:

1. **Build verification:**
   ```bash
   cd /Users/jonas/code/sapling/addons/isl && yarn build
   ```
   Should complete without errors.

2. **Code verification:**
   - RenderDag.css contains `scroll-margin-top: 30px` on `.render-dag-row`
   - CommitTreeList.css does NOT contain `scroll-margin-top`

3. **Functional verification (manual):**
   Start dev server: `cd /Users/jonas/code/sapling/addons/isl && yarn start`
   - Click a commit in the middle column
   - Selected commit should scroll to top with ~30px visible padding from the top edge
   - Should NOT be flush against the top (0px gap)
</verification>

<success_criteria>
- [ ] `scroll-margin-top: 30px` in RenderDag.css on .render-dag-row class
- [ ] NO `scroll-margin-top` in CommitTreeList.css
- [ ] Production build completes successfully
- [ ] Gap 1 from verification closed: scroll-margin-top now on correct element
</success_criteria>

<output>
After completion, create `.planning/phases/06-navigation-fixes/06-02-SUMMARY.md`
</output>
