---
phase: 04-details-panel
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - addons/isl/src/CommitInfoView/DiffStats.tsx
autonomous: true

must_haves:
  truths:
    - "Total line count is prominently displayed for Files Changed section"
    - "Line count format uses visual emphasis (bold/colored)"
    - "Line count appears with code icon and tooltip explaining SLOC"
  artifacts:
    - path: "addons/isl/src/CommitInfoView/DiffStats.tsx"
      provides: "Enhanced line count display"
      contains: "significantLinesOfCode"
  key_links:
    - from: "DiffStats.tsx"
      to: "CommitInfoView.tsx"
      via: "component import and rendering"
      pattern: "<DiffStats"
---

<objective>
Enhance line count display for visual prominence with improved formatting.

Purpose: Make the "lines changed" information more prominent and visually appealing in the Files Changed section.
Output: Enhanced DiffStats component with better visual treatment.

**Data constraint:** Current backend provides only total SLOC (significant lines of code), not separate +/- counts. Per-file line counts are also not available. This plan enhances visual presentation of available data. Future enhancement when backend provides +/- data is noted but not implemented.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-details-panel/04-CONTEXT.md
@.planning/phases/04-details-panel/04-RESEARCH.md
@addons/isl/src/CommitInfoView/DiffStats.tsx
@addons/isl/src/sloc/useFetchSignificantLinesOfCode.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance DiffStats visual prominence</name>
  <files>addons/isl/src/CommitInfoView/DiffStats.tsx</files>
  <action>
Enhance the DiffStats component to display line counts more prominently with GitHub/Graphite-style visual treatment.

1. **Update StyleX styles** for more prominent display:
   ```typescript
   const styles = stylex.create({
     locInfo: {
       alignItems: 'center',
       fontWeight: 'bold',
       textTransform: 'lowercase',
       fontSize: '85%',
       opacity: 0.9,
       gap: 'var(--halfpad)',
     },
     lineCount: {
       color: 'var(--highlight-foreground)',
       fontVariantNumeric: 'tabular-nums',
     },
   });
   ```

2. **Update ResolvedDiffStatsView** to apply enhanced styling:
   ```typescript
   function ResolvedDiffStatsView({
     significantLinesOfCode,
   }: {
     significantLinesOfCode: number | undefined;
   }) {
     if (significantLinesOfCode == null) {
       return null;
     }

     return (
       <DiffStatsView>
         <span {...stylex.props(styles.lineCount)}>
           <T replace={{$num: significantLinesOfCode}}>$num lines</T>
         </span>
       </DiffStatsView>
     );
   }
   ```

3. **Add comment for future +/- enhancement:**
   ```typescript
   // TODO: When backend provides separate added/deleted line counts,
   // update to show "+X/-Y" format with green/red coloring:
   // <span style={{color: 'var(--signal-success)'}}>+{added}</span>
   // <span>/</span>
   // <span style={{color: 'var(--signal-error)'}}>-{deleted}</span>
   ```

**Visual effect:**
- Line count uses highlight foreground color for emphasis
- Tabular numbers ensure consistent spacing
- Maintains existing bold weight and icon
- Ready for +/- format when data becomes available
  </action>
  <verify>
- `yarn eslint` passes in addons/isl
- `yarn test` passes
- Visual inspection: Line count is more prominent with highlight color
  </verify>
  <done>
- Line count display uses highlight color for visual prominence
- Numbers use tabular font variant for clean alignment
- Code documented for future +/- enhancement when backend supports it
  </done>
</task>

<task type="auto">
  <name>Task 2: Update PendingDiffStats for consistency</name>
  <files>addons/isl/src/CommitInfoView/DiffStats.tsx</files>
  <action>
Ensure PendingDiffStats (used in Changes to Amend section) has consistent styling with the enhanced DiffStats.

Both ResolvedDiffStatsView and PendingDiffStatsView use the same display component (DiffStatsView), so the styling enhancement in Task 1 automatically applies to both.

Verify this is the case - no additional code changes should be needed, but confirm the component hierarchy:
- `DiffStats` -> `ResolvedDiffStatsView` -> `DiffStatsView`
- `PendingDiffStats` -> `PendingDiffStatsView` -> `ResolvedDiffStatsView` -> `DiffStatsView`

If the hierarchy is correct, both sections will inherit the enhanced styling.

**Note:** This task is verification-only unless the hierarchy differs from expected.
  </action>
  <verify>
- Trace component usage to confirm shared DiffStatsView base
- Visual inspection: Both Files Changed and Changes to Amend (when expanded) show consistent line count styling
  </verify>
  <done>
- Both DiffStats and PendingDiffStats use consistent enhanced styling
- Visual treatment is uniform across the details panel
  </done>
</task>

</tasks>

<verification>
1. Start dev server: `cd addons/isl && yarn start`
2. Open ISL in browser
3. Select a commit with changed files
4. Verify:
   - Line count in Files Changed section uses highlight color
   - Numbers appear with tabular spacing
   - Code icon and tooltip remain present
5. Expand Changes to Amend section (if available)
6. Verify pending line count has same styling
</verification>

<success_criteria>
- Line count display is more visually prominent
- Consistent styling between committed and pending sections
- No regressions in existing functionality
- Code prepared for future +/- format enhancement
</success_criteria>

<output>
After completion, create `.planning/phases/04-details-panel/04-02-SUMMARY.md`
</output>
