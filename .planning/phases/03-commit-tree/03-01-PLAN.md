---
phase: 03-commit-tree
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - addons/isl/src/CommitTreeList.tsx
  - addons/isl/src/CommitTreeList.css
autonomous: true

must_haves:
  truths:
    - "Selecting a commit in stack column scrolls commit tree to show that commit"
    - "Selected commit is centered in the commit tree viewport"
    - "Selection in commit tree shows VS Code-style left border accent"
    - "Scroll animation is smooth, not jarring"
  artifacts:
    - path: "addons/isl/src/CommitTreeList.tsx"
      provides: "useScrollToSelectedCommit hook"
      contains: "scrollIntoView"
    - path: "addons/isl/src/CommitTreeList.css"
      provides: "Selection border styling"
      contains: "border-left"
  key_links:
    - from: "CommitTreeList.tsx"
      to: "selectedCommits atom"
      via: "useAtomValue in useScrollToSelectedCommit"
      pattern: "useAtomValue.*selectedCommits"
    - from: "commit-row-selected class"
      to: "border-left accent"
      via: "CSS selector"
      pattern: "commit-row-selected.*border-left"
---

<objective>
Implement auto-scroll synchronization and VS Code-style selection highlighting in the commit tree.

Purpose: When users click a commit in the stack column (left), the commit tree (middle) should smoothly scroll to show that commit centered in view. Selected commits should have a prominent left border accent like VS Code's file tree.

Output: Updated CommitTreeList.tsx with scroll hook, updated CSS with selection border styling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-commit-tree/03-CONTEXT.md
@.planning/phases/03-commit-tree/03-RESEARCH.md

@addons/isl/src/CommitTreeList.tsx
@addons/isl/src/CommitTreeList.css
@addons/isl/src/selection.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add useScrollToSelectedCommit hook</name>
  <files>addons/isl/src/CommitTreeList.tsx</files>
  <action>
Create a new hook `useScrollToSelectedCommit` that:
1. Uses `useAtomValue(selectedCommits)` to watch selection changes
2. When exactly one commit is selected, queries for element with `[data-commit-hash="${hash}"]`
3. Calls `scrollIntoView({behavior: 'smooth', block: 'center', inline: 'nearest'})` on the element
4. Uses setTimeout with 100ms delay to ensure DOM has rendered (proven pattern from ComparisonView.tsx)
5. Cleans up timer on effect cleanup

Add the hook call to the CommitTreeList component (after existing hooks like useArrowKeysToChangeSelection).

Pattern from research:
```typescript
function useScrollToSelectedCommit() {
  const selected = useAtomValue(selectedCommits);

  useEffect(() => {
    if (selected.size !== 1) {
      return;
    }

    const hash = Array.from(selected)[0];
    const timer = setTimeout(() => {
      const element = document.querySelector(`[data-commit-hash="${hash}"]`);
      if (element) {
        element.scrollIntoView({
          behavior: 'smooth',
          block: 'center',
          inline: 'nearest'
        });
      }
    }, 100);

    return () => clearTimeout(timer);
  }, [selected]);
}
```
  </action>
  <verify>
1. Run `cd /Users/jonas/code/sapling/addons/isl && yarn eslint src/CommitTreeList.tsx --fix`
2. Run `cd /Users/jonas/code/sapling/addons/isl && yarn build` to ensure no TypeScript errors
  </verify>
  <done>
- Hook is defined and called in CommitTreeList
- No lint or type errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Add VS Code-style selection border</name>
  <files>addons/isl/src/CommitTreeList.css</files>
  <action>
Update the existing `.commit-row-selected` rule to add VS Code-style left border accent:

```css
.commit-row-selected {
  background-color: var(--selected-commit-background);
  /* VS Code-style left border accent */
  border-left: 3px solid var(--graphite-accent, #4a90e2);
  margin-left: -3px; /* Prevent layout shift */
}
```

Add subtle hover state for commits to show clickability:

```css
.commit-rows:hover:not(.commit-row-selected) {
  background-color: rgba(255, 255, 255, 0.03);
}
```

Note: The `.commit-rows` class already has position: relative which is needed for the hover state to work properly.
  </action>
  <verify>
1. Run `cd /Users/jonas/code/sapling/addons/isl && yarn build` to ensure CSS is valid
2. Visual check: Start dev server, click commits, verify left border appears on selected
  </verify>
  <done>
- Selected commits have 3px left border in accent color
- No layout shift when selecting/deselecting
- Subtle hover state shows on non-selected commits
  </done>
</task>

</tasks>

<verification>
1. Start dev server: `cd /Users/jonas/code/sapling/addons && yarn dev`
2. Open ISL in browser
3. Click a commit in the stack column (left) - verify middle column scrolls smoothly to that commit
4. Click a commit in the commit tree (middle) - verify it gets a blue left border
5. Click different commits - verify scroll works and selection border moves
6. Verify no layout shift when selection changes
</verification>

<success_criteria>
- Selecting commit from stack auto-scrolls commit tree to center that commit
- Selected commits show 3px left border in soft blue (#4a90e2)
- Scroll animation is smooth (uses browser's smooth scroll)
- No layout shift when selecting/deselecting
- No lint or build errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-commit-tree/03-01-SUMMARY.md`
</output>
