# This file was @generated by getdeps.py

name: EdenSCM Lib EdenAPI Tools Mac

on:
  push:
    branches:
    - master
  pull_request:
    branches:
    - master

jobs:
  build:
    runs-on: macOS-latest
    env:
      DEVELOPER_DIR: /Applications/Xcode_10.3.app/Contents/Developer
    steps:
    - uses: actions/checkout@v1
    - name: Install Rust Stable
      uses: actions-rs/toolchain@v1
      with:
        toolchain: stable
        default: true
        profile: minimal
    - name: Install system deps
      run: sudo python3 build/fbcode_builder/getdeps.py --allow-system-packages install-system-deps --recursive eden_scm_lib_edenapi_tools
    - name: Build eden_scm_lib_edenapi_tools
      run: python3 build/fbcode_builder/getdeps.py --allow-system-packages build --src-dir=. eden_scm_lib_edenapi_tools  --project-install-prefix eden_scm_lib_edenapi_tools:/usr/local
    - name: Copy artifacts
      run: python3 build/fbcode_builder/getdeps.py --allow-system-packages fixup-dyn-deps --src-dir=. eden_scm_lib_edenapi_tools _artifacts/mac  --project-install-prefix eden_scm_lib_edenapi_tools:/usr/local --final-install-prefix /usr/local
    - uses: actions/upload-artifact@master
      with:
        name: eden_scm_lib_edenapi_tools
        path: _artifacts
    - name: Test eden_scm_lib_edenapi_tools
      run: python3 build/fbcode_builder/getdeps.py --allow-system-packages test --src-dir=. eden_scm_lib_edenapi_tools  --project-install-prefix eden_scm_lib_edenapi_tools:/usr/local
